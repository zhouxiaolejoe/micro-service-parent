<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.micro.service.springquartz.mapper.target.TargetMapper">

    <update id="createTableDynamic">
        create table ${tablename}( ${sqlData})
    </update>
    <delete id="deleteData">
            delete from ${tablename} where guid = #{guid,jdbcType=VARCHAR}
            <choose>
                <when test=" year != null and year != '' ">
                    and year = #{year,jdbcType=VARCHAR}
                </when>
                <otherwise>
                    and year is null
                </otherwise>
            </choose>
            <choose>
                <when test=" province != null and province != '' ">
                    and province = #{province,jdbcType=VARCHAR}
                </when>
                <otherwise>
                    and province is null
                </otherwise>
            </choose>
        </delete>

        <insert id="insertDataD">
            insert into ${tablename} (${sql})
            values(
                ${values}
            )
        </insert>

        <select id="queryTableMaxVersion" resultType="java.lang.String">
		select to_char(max(dbversion),'yyyymmddhh24miss') as dbversion from ${tablename}
	</select>
</mapper>